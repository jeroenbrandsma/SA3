%!TEX root = ../report.tex
\chapter{Architecture evaluation}
\label{ch:evaluation}
In this chapter the software architecture will be evaluated. This document started with a requirement analysis. The requirements which are defined in chapter 3 are checked if they are fulfilled in the software architecture. Another part in this chapter is the architecture evaluation using Architecture Tradeoff Analysis Method (ATAM). The architectural risks can be exposed that can harm the organization's business goals.

\section{Requirements validation}
The requirements from chapter 3 are evaluated in this section. The section is split according to chapter 3. First  the functional requirements, following the commercial requirements, and at the end the technical non-functional requirements.

\subsection{Functional requirements}
\begin{table}[H]
	\begin{tabular}{lllllL{0.5\textwidth}}
						    
		Nr.   & Priority & Fulfilled & Decision & Chapter & Remarks \\ \hline
		
		%		INTR-1 & Must     & Yes      &\ref{subsec:external-system} & Fulfilled by using several weather forecast API providers.       \\
		%The system is able to receive input from water level sensors.
		FR-1  & Must     & Yes        & &\ref{subsec:logicalview}, \ref{sec:hardware-decisions} & Fulfilled by the system providing a REST server the arduino sensor systems can use to post the sensor data to. \\ 
		
		%The system is able to perform an analysis for the water level in the waterways based on the input from the water level sensors. 
		FR-2  & Must     & Yes       & &\ref{subsec:logicalview}       & Fulfilled by having the system use several algorithms to analyze the sensor input for abnormalities \\ 
		%The system is able to receive input from the dike sensors.
		FR-3  & Must     & Yes        & &\ref{sec:hardware-decisions} \ref{hw:2}         & Fulfilled by having arduino systems sent the dike sensor values over a cabled network to the central system's REST server \\ 
		
		%The system is able to perform an analysis for the parameters of the dike sensors based on the input from the dike sensors.
		%TODO This has to be explained better i guess.
		FR-4  & Must     & Yes        &          & ~       \\ 
		
		%FR-5 Must The system can store the sensor data.
		FR-5  & Must     & Yes        & &\ref{subsec:implementview},\ref{DEC:6} & Fulfilled by using an ElasticSearch database that is capable of storing all the data needed.       \\ 
		
		%Sensor data, which has been previously stored, can be retrieved at a later moment.
		FR-6  & Must     & Yes & \ref{dec:6} & &Fulfilled by using an Elasticsearch database that is very robust, high available and scalable. Thereby enhancing the ability to store and receive data at all times. \\
		
%		%The system retrieves weather forecasting data from weather forecasting services,
%which consists of predictions about the precipitation, wind data and tide information.
%This is used by the system to help in determining when a flood becomes imminent
		FR-7  & Must     & Yes        & &\ref{subsec:external-system}         & Fulfilled by the system contacting several API's to base the decisions on. \\ 
		
		%The system is able to detect when a flood is imminent by combining the retrieved
%sensor data and weather forecasting data.
		FR-8  & Must     & Yes        & &\ref{subsec:logicalview}, \ref{subsubsec:proc-floodmonitor} & Fulfilled by the system using Longitudinal Data Analysis to correlate the sensor data with the forecast data \\ 
		
%		%The system retrieves geographic information, consisting of road data, terrain height
%data and demographic data (number of civilians living in affected area) from an
%external API.
		FR-9  & Must     & Yes        & &\ref{subsec:external-system} & Fulfilled by the system contacting an external GEO API over TCP/IP\\
		
%		%The system computes the area affected by a flood, in zones of 5 by 5 km, by using the
%location data of the sensors and geographic information.
		FR-10 & Must     & Yes        & \ref{dec:6} & \ref{database-data},\ref{subsec:external-system} & Fulfilled by the system storing the geographical data in an ElasticSearch database, capable of performing queries to get the specified area \\ 
		
%		%The system is able to perform an analysis, resulting in an estimated expected water
%level for areas which are affected by a flood, based on the water level sensor data,
%geographic data and weather forecast information.
		FR-11 & Must     & Yes & &\ref{sec:elaboratedmodel} \ref{subsec:logicalview}  & Fulfilled by using several different external API's for additional information together with a correlation algorithm and other analysis algorithms \\ 
		
%The system estimates how the water level in the areas affected by the flood will %develop for every hour, up to 12 hours in the future.
		FR-12 & Should & Yes & & \ref{subsec:logicalview} & Fulfilled by having the system multiple prediction algorithms to analyze the flood data\\ 

%The system can compute the number of civilians living in the areas affected by the flood.
%TODO: Still no idea what those APIs actually give. 
		FR-13 & Should & Yes &  & \ref{subsec:external-system} & Fulfilled by letting the system obtain the geo information of the civilians from an external API. Then letting the system store this geo data in the ElasticSearch database, capable of executing complex geo queries. \\

%When a flood is imminent, the system sends a warning to the safety region, containing information about the flood: the area affected by the flood, the expected water level in those areas, how the water level will develop in the coming hours and the number of civilians living in the affected area.
		FR-14 & Must     & ~        & ~         & ~         & ~\\ 

%		\frReqRow{compute-safearea}{Must}
%		{ The system can compute a safe area, not affected by the flood, where citizens can be evacuated to in case of an (imminent) flood. }
		FR-15 & Must     & Yes        & ~         & \ref{subsec:logicalview},    \ref{subsec:external-system} & Fulfilled by using an external geoinformation API together with Elasticsearch \\ 
		
%		\frReqRow{citizens-subscribe}{Must}
%		{ Citizens are able to subscribe to flood warnings about imminent floods. }
			
		FR-16 & Must     & Yes & ~         & \ref{subsec:system-alter}         & Fulfilled by using an external SMS service provider\\ 

%		\frReqRow{warn-citizens}{Must}
%		{ Citizens who are subscribed for flood warnings are warned about imminent floods by text message. }
		FR-17 & Must     & Yes        & ~         & \ref{subsec:system-alter} & Fulfilled by sending the warning message to the external SMS service provider,  who then distributes it\\ 

%		\frReqRow{detect-faultysensor}{Must}
%		{ The system can detect a faulty sensor, either when the sensor raises an error or when the data from the sensor is inconsistent with other sensor data. }

		%TODO add references:
		%TODO not explained good enough
		FR-18 & Must     & Yes       & ~         & \ref{subsec:logicalview} & Fulfilled by using algorithms to detect abnormalities and then verifying the abnormalities using the other sensors and algorithms\\ 

%TODO
%		\frReqRow{controlpanel}{Must}
%		{ There is a control panel, where maintainers of the system have access to. } 
		FR-19 & Must     & ~        & ~         & ~         & ~         \\ 

%TODO This control panel is not enough described (and do we still use it?)
%		\frReqRow{report-faultysensors}{Must}
%		{ The system reports faulty sensors, so they can be viewed in the control panel. }
		FR-20 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{controlpanel-warnings}{Must}
%		{ Warnings of the system can be viewed in the control panel.}
		FR-21 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{controlpanel-errors}{Must}
%		{ Errors of the system can be viewed in the control panel. }
		FR-22 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{controlpanel-sensors}{Must}
%		{ The readings of the sensors can be viewed in the control panel. }
		FR-23 & Must     & ~        & ~         & ~         & ~         \\ 

%TODO
%		Joris: The backups are kind of created by having redundancy
%		\frReqRow{make-backups}{Must}
%		{ The system can make backups of its data (configuration data etc.). }
		FR-24 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{store-backups}{Must}
%		{ The system can store created backups on a remote location.}
		FR-25 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{retrieve-backups}{Must}
%		{ The system can retrieve the backups it previously created.}
		FR-26 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{restore-backups}{Must}
%		{ The system can restore the backups it previously created after retrieving them. }
		FR-27 & Must     & ~        & ~         & ~         & ~         \\ 

%		\frReqRow{expose-api}{Must}
%		{ The system exposes an API, allowing third parties to develop applications for guidance of the citizens during a flood. }
		FR-28 & Must     & Yes        &          & \ref{sec:elaboratedmodel}, \ref{subsec:logicalview}, \ref{sec:archvision}, \ref{subsec:implementview} & Fulfilled by hosting a REST sever API\\ 

%TODO 	Can it?
%		\frReqRow{detect-extremephenomena}{Could}
%		{ The system is able to detect extreme weather phenomena, like storms etc. }
		FR-29 & Could    & ~        & ~         & ~         & ~         \\

%TODO explain what algorithms are used?
%		\frReqRow{uav}{Should}
%		{ The system processes and stores data collected using a UAV. }	
		FR-30 & Should	 & Yes        & \ref{hw:4}         & \ref{subsec:databaseview} & Fulfilled by having a database capable of storing images and geo information\\
						
	\end{tabular}
\end{table}

	\subsection{Commercial non-functional requirements}
	\begin{table}[H]
	\begin{tabular}{lllll}
	
	Nr.    & Priority & Fulfilled & Location & Remarks \\ \hline
	
%	\reqRow{cnfr}{Must}{The system is affordable. The initial price of the system is lower than 95\%\ of the competitors price in the same market.}
	CNFR-1 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{cnfr}{Must}{The sensors have a good quality, so they do not have to be replaced often. The expected lifetime of the sensors should be at least three years.}
	CNFR-2 & Must     & ~        & ~         & ~       \\
	
	\end{tabular}
	\end{table}
	
	\subsection{Technical non-functional requirements}
	\subsubsection{Reliability}
	\begin{table}[H]
	\begin{tabular}{lllll}
	
	Nr.   & Priority & Fulfilled & Location & Remarks \\ \hline
	
%	\reqRow{rel}{Must}{Data from the sensors is sent via a TCP connection} %	
	REL-1 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{rel}{Must}{The system must detect if a sensor supplies wrong measurements, which can be caused, e.g. by improper calibration or defects in the sensor.} 
	REL-2 & Must     & Yes      & ~    \ref{subsec:detecting-faulty-sensor}     & Fulfilled, faulty sensor will be detected and later be repaired.       \\ 
	
%	\reqRow{rel}{Must}{The system must at no time fail to detect a flood when this flood becomes imminent (\textit{false negative}).}
	REL-3 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{rel}{Must}{The system must not detect a flood, when this flood is not there in reality (\textit{false positive}), on average more than once per 5 years.}
	REL-4 & Must     & ~        & ~         & ~       \\
	
	\end{tabular}
	\end{table}
	
	\subsubsection{Availability}
	\begin{table}[H]
	\begin{tabular}{lllll}
	
	Nr.   & Priority & Fulfilled & Location & Remarks \\ \hline
	
%	\reqRow{ava}{Must}{The system must have an uptime of $99.7\%$. This effectively means, that the system should not be down for more than 2 hours per month.
	AVA-1 & Must     & Yes        & \ref{subsec:availability}         & Fulfilled.       \\ 
	
%	\reqRow{ava}{Must}{The system must not experience a period of downtime, spanning more than 12 hours. Within twelve hours of the system going offline, it should be back up again. }
	AVA-2 & Must     & ~        & ~         & ~       \\
	
	\end{tabular}
	\end{table}
	
	\subsubsection{Resilience}
	\begin{table}[H]
	\begin{tabular}{lllll}
	
	Nr.   & Priority & Fulfilled & Location & Remarks \\ \hline
	
%	\reqRow{res}{Must}{The system recognizes failures within half an hour}
	
	RES-1 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{res}{Must}{The system recovers from failures without the \qos or the functionality of the system being affected.} % GK: split in two requirements. reduce to detect sensor failures within half an hour
	
	RES-2 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{res}{Must}{All system data must be backed up every 24 hours, so that in case of data loss, this data can be restored.}
	RES-3 & Must     & Yes        & \ref{subsec:database-data}         & Fulfilled, the data is also duplicated in database.       \\ 
	
%	\reqRow{res}{Must}{In case of a data loss, the data should be retrieved and restored from a backup within 2 hours.}
	RES-4 & Must     & ~        & ~         & ~       \\ 
	
%	\reqRow{res}{Must}{Backup copies are stored in a secure location which is not in the same area as the system (50 km).}		
	RES-5 & Must     & Yes        & \ref{sec:hardware-overview}         & Fulfilled, the data centers will be located in three different places.       \\
	
	\end{tabular}
	\end{table}
	
	\subsubsection{Performance}
	\begin{table}[H]
	\begin{tabular}{llllL{0.5\textwidth}}
	
	Nr.    & Priority & Fulfilled & Location & Remarks \\ \hline
	
%	\reqRow{perf}{Must}{Data is transmitted from and to the system with a minimum average speed of 10 megabits per second}
	PERF-1 & Must     & Unknown  & -         & Expected, not yet tested. \\
	
%	\reqRow{perf}{Must}{	The data transmission between the sensors and the system is on average at least 10 megabits per second for each sensor.}
	PERF-2 & Must     & Unknown  & -         & Expected, not yet tested. \\
	
%	\reqRow{perf}{Must}{	The time for the system to compute if there is a flood or not according to a critical level and the data received from the sensors is at most 5 minutes. }
	PERF-3 & Must     & Unknown  & -         & Expected, not yet tested. \\
	
%	\reqRow{perf}{Must}{ If an imminent flood is detected, the warning text message to citizens arrives in 5 minutes. }
	PERF-4 & Must     & Unknown  & -         & Expected, not yet tested. \\
	
%	\reqRow{perf}{Must}{ If an imminent flood is detected, the warning to the emergency room arrives within 1 minute. }
	PERF-5 & Must     & Unknown  & -         & Expected, not yet tested. \\
						
	\end{tabular}
\end{table}

\subsubsection{Interoperability}
\begin{table}[H]
	\begin{tabular}{lllll}
						    
		Nr.    & Priority & Fulfilled & Location & Remarks \\ \hline
		INTR-1 & Must     & Yes      &\ref{subsec:external-system} & Fulfilled by using several weather forecast API providers.       \\ 
		INTR-2 & Must     & Yes      &\ref{subsec:users-roles}, \ref{subsec:external-system}, \ref{subsec:channels-information-flows}& Fulfilled by notifying Safety Region using API.\\ 
		INTR-3 & Must     & Yes      &\ref{subsec:external-system} & Fulfilled by sending SMS to subscribed citizens. \\ 
		INTR-4 & Must     & Yes      & \ref{sec:hardware-overview} & Fulfilled by using GeoBeads and Water level sensor. \\ 
		INTR-5 & Must     & Yes      & \ref{subsec:external-system} & Fulfilled by gathering ground height and waterways data. \\ 
		INTR-6 & Must     & Yes      & \ref{subsec:users-roles} & Fulfilled by exposing API to third party developers.       \\ 
						
	\end{tabular}
\end{table}

\subsubsection{Security}
\begin{table}[H]
	\begin{tabular}{lllll}
						    
		Nr.   & Priority & Fulfilled & Location & Remarks \\ \hline
		SEC-1 & Must     & Yes      & \ref{subsec:system-diagram} & Fulfilled. \\ 
		SEC-2 & Must     & Yes      & \ref{subsec:channels-information-flows} & Fulfilled. \\ 
		SEC-3 & Must     & Yes      & \ref{subsec:database-data} & Fulfilled, applied in Elasticsearch DB. \\ 
		SEC-4 & Must     & Yes      & \ref{sec:hardware-overview} & Fulfilled, in the data center level. \\ 
		SEC-5 & Must     & Yes      & \ref{sec:hardware-overview} & Fulfilled, by using Arduino to send data.\\
						
	\end{tabular}
\end{table}

\subsubsection{Scalability}
\begin{table}[H]
	\begin{tabular}{lllll}
						    
		Nr.     & Priority & Fulfilled & Location & Remarks \\ \hline
		SCALE-1 & Must     & Yes      & \ref{subsec:database-data} & Fulfilled by adapting Elasticsearch. \\ 
		SCALE-2 & Must     & Yes      & \ref{sec:hardware-overview} & Fulfilled by adapting multiple data centers and multiple sensor type. \\ 
		SCALE-3 & Must     & Unknown  & -         & Expected, not yet tested. \\
						
	\end{tabular}
\end{table}

\clearpage
\input{8-evaluation/architectureevaluation.tex}

